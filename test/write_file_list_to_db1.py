import os, sys
os.environ.setdefault("DJANGO_SETTINGS_MODULE", "SegmentationCheck.settings")
import django
django.setup()
from segmentation.models import Page

def write_file_list_to_db():
    file_lst = ['K0001V01P0034a', 'K0001V01P0034b', 'K0001V01P0034c', 'K0001V01P0035a', 'K0001V01P0035b', 'K0001V01P0035c', 'K0001V01P0036a', 'K0001V01P0036b', 'K0001V01P0036c', 'K0001V01P0037a', 'K0001V01P0037b', 'K0001V01P0037c', 'K0001V01P0038a', 'K0001V01P0038b', 'K0001V01P0038c', 'K0001V01P0200a', 'K0001V01P0200b', 'K0001V01P0200c', 'K0001V01P0201a', 'K0001V01P0201b', 'K0001V01P0201c', 'K0001V01P0202a', 'K0001V01P0202b', 'K0001V01P0202c', 'K0001V01P0203a', 'K0001V01P0203b', 'K0001V01P0203c', 'K0001V01P0204a', 'K0001V01P0204b', 'K0001V01P0204c', 'K0001V01P0205a', 'K0001V01P0205b', 'K0001V01P0205c', 'K0001V01P0206a', 'K0001V01P0206b', 'K0001V01P0206c', 'K0001V01P0207a', 'K0001V01P0207b', 'K0001V01P0207c', 'K0001V01P0208a', 'K0001V01P0208b', 'K0001V01P0208c', 'K0001V01P0209a', 'K0001V01P0209b', 'K0001V01P0209c', 'K0001V01P0210a', 'K0001V01P0210b', 'K0001V01P0210c', 'K0001V01P0211a', 'K0001V01P0211b', 'K0001V01P0211c', 'K0001V01P0212a', 'K0001V01P0212b', 'K0001V01P0212c', 'K0001V01P0213a', 'K0001V01P0213b', 'K0001V01P0213c', 'K0001V01P0214a', 'K0001V01P0214b', 'K0001V01P0214c', 'K0001V01P0215a', 'K0001V01P0215b', 'K0001V01P0215c', 'K0001V01P0216a', 'K0001V01P0216b', 'K0001V01P0216c', 'K0001V01P0217a', 'K0001V01P0217b', 'K0001V01P0217c', 'K0001V01P0218a', 'K0001V01P0218b', 'K0001V01P0218c', 'K0001V01P0219a', 'K0001V01P0219b', 'K0001V01P0219c', 'K0001V01P0220a', 'K0001V01P0220b', 'K0001V01P0220c', 'K0001V01P0221a', 'K0001V01P0221b', 'K0001V01P0221c', 'K0001V01P0222a', 'K0001V01P0222b', 'K0001V01P0222c', 'K0001V01P0223a', 'K0001V01P0223b', 'K0001V01P0223c', 'K0001V01P0224a', 'K0001V01P0224b', 'K0001V01P0224c', 'K0001V01P0225a', 'K0001V01P0225b', 'K0001V01P0225c', 'K0001V01P0226a', 'K0001V01P0226b', 'K0001V01P0226c', 'K0001V01P0227a', 'K0001V01P0227b', 'K0001V01P0227c', 'K0001V01P0228a', 'K0001V01P0228b', 'K0001V01P0228c', 'K0001V01P0229a', 'K0001V01P0229b', 'K0001V01P0229c', 'K0001V01P0230a', 'K0001V01P0230b', 'K0001V01P0230c', 'K0001V01P0231a', 'K0001V01P0231b', 'K0001V01P0231c', 'K0001V01P0232a', 'K0001V01P0232b', 'K0001V01P0232c', 'K0001V01P0233a', 'K0001V01P0233b', 'K0001V01P0233c', 'K0001V01P0234a', 'K0001V01P0234b', 'K0001V01P0234c', 'K0001V01P0235a', 'K0001V01P0235b', 'K0001V01P0235c', 'K0001V01P0236a', 'K0001V01P0236b', 'K0001V01P0236c', 'K0001V01P0237a', 'K0001V01P0237b', 'K0001V01P0237c', 'K0001V01P0238a', 'K0001V01P0238b', 'K0001V01P0238c', 'K0001V01P0239a', 'K0001V01P0239b', 'K0001V01P0239c', 'K0001V01P0240a', 'K0001V01P0240b', 'K0001V01P0240c', 'K0001V01P0241a', 'K0001V01P0241b', 'K0001V01P0241c', 'K0001V01P0242a', 'K0001V01P0242b', 'K0001V01P0242c', 'K0001V01P0243a', 'K0001V01P0243b', 'K0001V01P0243c', 'K0001V01P0244a', 'K0001V01P0244b', 'K0001V01P0244c', 'K0001V01P0245a', 'K0001V01P0245b', 'K0001V01P0245c', 'K0001V01P0246a', 'K0001V01P0246b', 'K0001V01P0246c', 'K0001V01P0247a', 'K0001V01P0247b', 'K0001V01P0247c', 'K0001V01P0248a', 'K0001V01P0248b', 'K0001V01P0248c', 'K0001V01P0249a', 'K0001V01P0249b', 'K0001V01P0249c', 'K0001V01P0250a', 'K0001V01P0250b', 'K0001V01P0250c', 'K0001V01P0251a', 'K0001V01P0251b', 'K0001V01P0251c', 'K0001V01P0252a', 'K0001V01P0252b', 'K0001V01P0252c', 'K0001V01P0253a', 'K0001V01P0253b', 'K0001V01P0253c', 'K0001V01P0254a', 'K0001V01P0254b', 'K0001V01P0254c', 'K0001V01P0255a', 'K0001V01P0255b', 'K0001V01P0255c', 'K0001V01P0256a', 'K0001V01P0256b', 'K0001V01P0256c', 'K0001V01P0257a', 'K0001V01P0257b', 'K0001V01P0257c', 'K0001V01P0258a', 'K0001V01P0258b', 'K0001V01P0258c', 'K0001V01P0259a', 'K0001V01P0259b', 'K0001V01P0259c', 'K0001V01P0260a', 'K0001V01P0260b', 'K0001V01P0260c', 'K0001V01P0261a', 'K0001V01P0261b', 'K0001V01P0261c', 'K0001V01P0262a', 'K0001V01P0262b', 'K0001V01P0262c', 'K0001V01P0263a', 'K0001V01P0263b', 'K0001V01P0263c', 'K0001V01P0264a', 'K0001V01P0264b', 'K0001V01P0264c', 'K0001V01P0265a', 'K0001V01P0265b', 'K0001V01P0265c', 'K0001V01P0266a', 'K0001V01P0266b', 'K0001V01P0266c', 'K0001V01P0267a', 'K0001V01P0267b', 'K0001V01P0267c', 'K0001V01P0268a', 'K0001V01P0268b', 'K0001V01P0268c', 'K0001V01P0269a', 'K0001V01P0269b', 'K0001V01P0269c', 'K0001V01P0270a', 'K0001V01P0270b', 'K0001V01P0270c', 'K0001V01P0271a', 'K0001V01P0271b', 'K0001V01P0271c', 'K0001V01P0272a', 'K0001V01P0272b', 'K0001V01P0272c', 'K0001V01P0273a', 'K0001V01P0273b', 'K0001V01P0273c', 'K0001V01P0274a', 'K0001V01P0274b', 'K0001V01P0274c', 'K0001V01P0275a', 'K0001V01P0275b', 'K0001V01P0275c', 'K0001V01P0276a', 'K0001V01P0276b', 'K0001V01P0276c', 'K0001V01P0277a', 'K0001V01P0277b', 'K0001V01P0277c', 'K0001V01P0278a', 'K0001V01P0278b', 'K0001V01P0278c', 'K0001V01P0279a', 'K0001V01P0279b', 'K0001V01P0279c', 'K0001V01P0280a', 'K0001V01P0280b', 'K0001V01P0280c', 'K0001V01P0281a', 'K0001V01P0281b', 'K0001V01P0281c', 'K0001V01P0282a', 'K0001V01P0282b', 'K0001V01P0282c', 'K0001V01P0283a', 'K0001V01P0283b', 'K0001V01P0283c', 'K0001V01P0284a', 'K0001V01P0284b', 'K0001V01P0284c', 'K0001V01P0285a', 'K0001V01P0285b', 'K0001V01P0285c', 'K0001V01P0286a', 'K0001V01P0286b', 'K0001V01P0286c', 'K0001V01P0287a', 'K0001V01P0287b', 'K0001V01P0287c', 'K0001V01P0288a', 'K0001V01P0288b', 'K0001V01P0288c', 'K0001V01P0289a', 'K0001V01P0289b', 'K0001V01P0289c', 'K0001V01P0290a', 'K0001V01P0290b', 'K0001V01P0290c', 'K0001V01P0291a', 'K0001V01P0291b', 'K0001V01P0291c', 'K0001V01P0292a', 'K0001V01P0292b', 'K0001V01P0292c', 'K0001V01P0293a', 'K0001V01P0293b', 'K0001V01P0293c', 'K0001V01P0294a', 'K0001V01P0294b', 'K0001V01P0294c', 'K0001V01P0295a', 'K0001V01P0295b', 'K0001V01P0295c', 'K0001V01P0296a', 'K0001V01P0296b', 'K0001V01P0296c', 'K0001V01P0297a', 'K0001V01P0297b', 'K0001V01P0297c', 'K0001V01P0298a', 'K0001V01P0298b', 'K0001V01P0298c', 'K0001V01P0299a', 'K0001V01P0299b', 'K0001V01P0299c', 'K0079V08P0189a', 'K0079V08P0189b', 'K0079V08P0189c', 'K0079V08P0190a', 'K0079V08P0190b', 'K0079V08P0190c', 'K0079V08P0191a', 'K0079V08P0191b', 'K0079V08P0191c', 'K0079V08P0192a', 'K0079V08P0192b', 'K0079V08P0192c', 'K0079V08P0193a', 'K0079V08P0193b', 'K0079V08P0193c', 'K0079V08P0194a', 'K0079V08P0194b', 'K0079V08P0194c', 'K0079V08P0195a', 'K0079V08P0195b', 'K0079V08P0195c', 'K0079V08P0196a', 'K0079V08P0196b', 'K0079V08P0196c', 'K0079V08P0197a', 'K0079V08P0197b', 'K0079V08P0198a', 'K0079V08P0198b', 'K0079V08P0198c', 'K0079V08P0199a', 'K0079V08P0199b', 'K0079V08P0199c', 'K0079V08P0200a', 'K0079V08P0200b', 'K0079V08P0200c']
    page_lst = []
    for _id in file_lst:
        text = u''
        text_file = '/opt/share/dzj_characters/page_images/'+_id+'.txt'
        try:
            with open(text_file, 'r') as f_text:
                text = f_text.read()
                text = text.decode('utf-8')
                imagefile = _id+'.jpg'
        except:
            next
        page = Page(id=_id, text=text, image=imagefile.decode('utf-8'))
        page_lst.append(page)
        if len(page_lst) >= 100:
            Page.objects.bulk_create(page_lst)
            page_lst = []
    if page_lst:
        Page.objects.bulk_create(page_lst)
        page_lst = []

if __name__ == '__main__':
    write_file_list_to_db()

def run():
    write_file_list_to_db()